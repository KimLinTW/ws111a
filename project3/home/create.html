<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="https://kit.fontawesome.com/5b08644e8c.js" crossorigin="anonymous"></script>
    </head>
    <script src="../callPy.js"></script>
    <body style="background-color:rgb(252,240,228);">
        <br><br><br><br><br><br><br><br>
        <div id="" class="card-layout">
            <h2>Post !</h2>
            <p><i ></i><input id = "title" type="text" placeholder="Title"/></p>
            <p><i ></i><textarea id="content" type="text" placeholder="Content" rows="30" cols="40" maxlength="200" ></textarea></p>
            <p><i ></i><input id = "img" type="text" placeholder="img URL"/></p>
            <br><br>
            <button style="background-color:#f0b446;" onclick="post()" >Submit</button>
            <pre id="s"></pre>
            <pre id="s2"></pre>
            <pre id="s3"></pre>
            <pre id="s4"></pre>
        </div>
    </body>
    <script>
        async function post() {
            let titl = document.getElementById("title").value
            let cont = document.getElementById("content").value
            let img = document.getElementById("img").value
             document.getElementById("s").innerText = titl
             document.getElementById("s2").innerText = cont
             document.getElementById("s3").innerText = img
            let aut = await window.fetch(`/log_get/me`)
          document.getElementById("s4").innerText = 32
            let obj2 = await aut.json()
          document.getElementById("s4").innerText = 33
            let result2 = await JSON.stringify( obj2["send"])
            document.getElementById("s3").innerText = result2
            aut = result2
            let tmp = 'post$' + titl + '$' + cont + '$' + img + '$' + aut
             document.getElementById("s4").innerText = tmp
            let r = await window.fetch(`/c_post/${tmp}`)
            let obj = await r.json() 
            result = await JSON.stringify( obj["send"])
            document.getElementById('ss').innerText = result


        }


        async function tst(){
            document.getElementById("tt").innerText = "1"
            let r = await window.fetch(`/log_get/any`)
            let obj = await r.json()
            let result = await JSON.stringify( obj["send"])
            if (result[2] == '"'){
                document.getElementById("tt").innerText = "未登入"
            }else{
                document.getElementById("tt").innerText = "您好，"+result
            }

            //document.getElementById("tt").innerText = result[1] == '"'
            //document.getElementById("tt").innerText = result

        }
        async function log_out(){
            let r = await window.fetch(`/log_get/out`)
            tst()
        }
    </script>
</html>
