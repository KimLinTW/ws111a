<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="https://kit.fontawesome.com/5b08644e8c.js" crossorigin="anonymous"></script>
    </head>
    <script src="./yes.js"></script>
    <!-- <script src="../callPy.js"></script> -->
    <body style="background-color:rgb(252,240,228);">
        <br><br><br><br><br><br><br><br>
        <div id="" class="card-layout">
            <h2>Sign up</h2>
            <p><i class="fa-solid fa-user-astronaut"></i><input id="name" type="text"  placeholder="Your name"/></p>
            <p><i class="fa-solid fa-globe"></i><input id="mail" type="text" placeholder="Your email"/></p>
            <p><i class="fa-solid fa-shuttle-space"></i><input id="pas" type="password" placeholder="Password"/></p>
            <p><i class="fa-solid fa-meteor"></i><input type="password" placeholder="Retype your password again"/></p>
            <br><p><input type="checkbox"> I agree all statements in <a href="#">Terms of service</a></p>
            <br><br>

            <button onclick="signup()" >Submit</button>
            <pre id = 'ss'></pre>
            <pre id = 'a'></pre>
            <pre id = 'b'></pre>
            <pre id = 'd'></pre>
            
        </div>
    </body>
    <script>
        async function signup() {
            // sign up
            name = document.getElementById('name').value
            pas = document.getElementById('pas').value
            mail = document.getElementById('mail').value

            let result="raw"
            let indata = "isSign."+name+"."+pas+"."+mail

            // let testdata = "isSign.Kim.abc123.linkim0914@gmail.com"
            document.getElementById('ss').innerText = "waiting..."
            // result = await input(testdata);
            
            // document.getElementById('a').innerText = tst()
            // document.getElementById('ss').innerText = "註冊成功"
            let tmp = Boolean(name) && Boolean(pas) && Boolean(mail)
            if (!tmp) {
                document.getElementById('ss').innerText = "資料不完整!"
                return
            } 

            let r = await window.fetch(`/test/${indata}`)
            let obj = await r.json() 
            result = await JSON.stringify( obj["send"])
            document.getElementById('ss').innerText = result
            
            // document.getElementById('a').innerText = result[1]+result[2]
            // document.getElementById('b').innerText = result[1]+result[2]
             


            if("OK" == result[1]+result[2]){
                document.getElementById('ss').innerText = "註冊成功!"
                document.getElementById('ss').innerHTML = '<a href="./index.html" >登入成功(回首頁)</a>'
                let r2 = await window.fetch(`/log/${name}`)
            }else{
                document.getElementById('ss').innerText = "此帳號已經存在!"
            }
        }
    </script>
    
</html>
